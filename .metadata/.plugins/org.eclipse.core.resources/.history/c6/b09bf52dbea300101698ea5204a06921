/*
 * Stepper.h
 *
 *  Created on: Sep 10, 2025
 *      Author: Andrea
 */
#include <stdint.h>
#include "tim.h"

//#include <map>

#ifndef INC_STEPPER_H_
#define INC_STEPPER_H_


class Stepper {
	public:

		int8_t id;													//Id motor
		int32_t resolution;       									//Number of steps for revolution
		float Current_Speed=0;  									//Actual speed value
		float Target_Speed=0;   									//Target speed value
		float Acceleration=0;   									//Acceleration, quadratic ramp
		float Actual_position=0;
		float Target_position=0;
		uint32_t last_update = 0;
		Stepper(){}
		Stepper (int8_t ID, int32_t Resolution, float Acc);			//Constructor


		//Setting up
		void SetVelocity(float rpm);
		void SetAcceleration(float acc);

		//Modes of operation
		void ProfileVelocity();
		void ProfilePosition (int32_t Position);

		//Utilities
		void QuickStop();
		void ResetMotor();

		//Conversions
		float Rpm_to_StepS(float rpm);
		float Angle_to_steps(float angle);
	private:
		//Utilities
		void setStepsFreq(float arr);
};




#endif /* INC_STEPPER_H_ */
